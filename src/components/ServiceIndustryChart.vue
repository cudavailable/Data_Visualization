<template>
  <div class="right_part">
    <h2 class="map-title">酒店数量与GDP关系</h2>
    <div ref="chartDom" class="chart-container"></div>
    <div class="button_group">
      <button 
        @click="switchChart(0)" 
        :class="{ active: currentChart === 0 }">
        2000年
      </button>
      <button 
        @click="switchChart(1)" 
        :class="{ active: currentChart === 1 }">
        2010年
      </button>
      <button 
        @click="switchChart(2)" 
        :class="{ active: currentChart === 2 }">
        2020年
      </button>
    </div>
  </div>
</template>

<script>
import { ref, onMounted, onUnmounted } from 'vue';
import * as echarts from 'echarts';

export default {
  setup() {
    const currentChart = ref(0);
    const chartDom = ref(null);
    let chartInstance = null;

    const chartsOptions = [
      {
        tooltip: {
          trigger: 'item',
          formatter: function(params) {
            return `${params.value[3]}<br>酒店数量:${params.value[2]}家\n<br>GDP:${params.value[4]}亿元`;
          }
        },
        legend: {
          show: true,
          data: ['GDP','酒店数量'],
          left: 40,
          top: 20,
        },
        xAxis: {
          scale: true,
        },
        yAxis: {
          scale: true,
        },
        series: [
          {
            name: 'GDP',
            type: 'scatter',
            symbolSize: (data) => {return Math.sqrt(data[4]/15)},
            data: [[130, 31.28 ,164,'上海',4812.2], [116.40, 45,328,'北京',3277.8],[120,42,43,'天津',1591.7],
              [98,25,83,'重庆',1822.1],[108,48,74,'内蒙古自治区',1539.1],[100,15,137,'广西壮族自治区',2080.0],
              [85,31.76,15,'西藏自治区',117.8],[100,41,27,'宁夏回族自治区',295.0],[84.61,42.89,27,'新疆维吾尔自治区',1363.6],
              [112,39.44,234,'河北',4628.2],[105,40,152,'山西',1845.7],[127,48,36,'吉林',1751.4],
              [124,44,136,'辽宁',4669.1],[130,50,80,'黑龙江',2855.5],[100,35,97,'陕西',1804.0],
              [90,40,92,'甘肃',1052.9],[87,35.62,13,'青海',263.7],[118.01,36.37,332,'山东',8278.1],
              [121,20,168,'福建',3764.5],[126,25,369,'浙江',6164.8],[112,31,175,'河南',5053.0],
              [106,29,122,'湖北',3545.4],[105,21,102,'湖南',3551.5],[115,24,67,'江西',2003.1],
              [125,34,323,'江苏',8553.7],[119,28,135,'安徽',3125.3],[114.98,15,515,'广东',10810.2],
              [109,12,49,'海南',526.8],[90,25,300,'四川',3928.2],[95,18,28,'贵州',1029.9],
              [90,15,182,'云南',2030.1]],
            itemStyle: {
              color: '#6495ED'
            },
          },
          {
            name: '酒店数量',
            type: 'scatter',
            symbolSize: (data) => {return Math.sqrt(data[2]/8)},
            data: [[130, 31.28 ,164,'上海',4812.2], [116.40, 45,328,'北京',3277.8],[120,42,43,'天津',1591.7],
              [98,25,83,'重庆',1822.1],[108,48,74,'内蒙古自治区',1539.1],[100,15,137,'广西壮族自治区',2080.0],
              [85,31.76,15,'西藏自治区',117.8],[100,41,27,'宁夏回族自治区',295.0],[84.61,42.89,27,'新疆维吾尔自治区',1363.6],
              [112,39.44,234,'河北',4628.2],[105,40,152,'山西',1845.7],[127,48,36,'吉林',1751.4],
              [124,44,136,'辽宁',4669.1],[130,50,80,'黑龙江',2855.5],[100,35,97,'陕西',1804.0],
              [90,40,92,'甘肃',1052.9],[87,35.62,13,'青海',263.7],[118.01,36.37,332,'山东',8278.1],
              [121,20,168,'福建',3764.5],[126,25,369,'浙江',6164.8],[112,31,175,'河南',5053.0],
              [106,29,122,'湖北',3545.4],[105,21,102,'湖南',3551.5],[115,24,67,'江西',2003.1],
              [125,34,323,'江苏',8553.7],[119,28,135,'安徽',3125.3],[114.98,15,515,'广东',10810.2],
              [109,12,49,'海南',526.8],[90,25,300,'四川',3928.2],[95,18,28,'贵州',1029.9],
              [90,15,182,'云南',2030.1]],
            itemStyle: {
              color: '#90EE90'
            },
          },
        ]
      },
      {
  tooltip: {
    trigger: 'item',
    formatter: function(params) {
      return `${params.value[3]}<br>酒店数量:${params.value[2]}家\n<br>GDP:${params.value[4]}亿元`;
    }
  },
  legend: {
    show: true,
    data: ['GDP','酒店数量'],
    left: 40,
    top: 20,
  },
  xAxis: {
    scale: true,
  },
  yAxis: {
    scale: true,
  },
  series: [
    {
      name: 'GDP',
      type: 'scatter',
      symbolSize: (data) => {return Math.sqrt(data[4]/15)},
      data: [[130, 31.28 ,1409,'上海',17915.4], [116.40, 45,1943,'北京',14964.0],[120,42,392,'天津',6830.8],
        [98,25,1037,'重庆',8065.3],[108,48,994,'内蒙古自治区',8199.9],[100,15,1323,'广西壮族自治区',8552.4],
        [85,31.76,184,'西藏自治区',512.9],[100,41,238,'宁夏回族自治区',1571.7],[84.61,42.89,679,'新疆维吾尔自治区',5360.2],
        [112,39.44,1893,'河北',18003.6],[105,40,1108,'山西',8903.99],[127,48,517,'吉林',6410.5],
        [124,44,1327,'辽宁',13896.3],[130,50,781,'黑龙江',8308.3],[100,35,1017,'陕西',9845.2],
        [90,40,537,'甘肃',3943.7],[87,35.62,209,'青海',1144.2],[118.01,36.37,3743,'山东',33922.5],
        [121,20,1580,'福建',15002.5],[126,25,3291,'浙江',27399.9],[112,31,1507,'河南',22655.0],
        [106,29,1892,'湖北',16226.9],[105,21,1559,'湖南',15574.3],[115,24,1178,'江西',9383.2],
        [125,34,3558,'江苏',41383.9],[119,28,1813,'安徽',13249.8],[114.98,15,4640,'广东',45944.6],
        [109,12,427,'海南',2020.5],[90,25,3446,'四川',17224.8],[95,18,619,'贵州',4519.0],
        [90,15,1616,'云南',7735.3]],
      itemStyle: {
        color: '#6495ED'
      },
    },
    {
      name: '酒店数量',
      type: 'scatter',
      symbolSize: (data) => {return Math.sqrt(data[2]/8)},
      data: [[130, 31.28 ,1409,'上海',17915.4], [116.40, 45,1943,'北京',14964.0],[120,42,392,'天津',6830.8],
        [98,25,1037,'重庆',8065.3],[108,48,994,'内蒙古自治区',8199.9],[100,15,1323,'广西壮族自治区',8552.4],
        [85,31.76,184,'西藏自治区',512.9],[100,41,238,'宁夏回族自治区',1571.7],[84.61,42.89,679,'新疆维吾尔自治区',5360.2],
        [112,39.44,1893,'河北',18003.6],[105,40,1108,'山西',8903.99],[127,48,517,'吉林',6410.5],
        [124,44,1327,'辽宁',13896.3],[130,50,781,'黑龙江',8308.3],[100,35,1017,'陕西',9845.2],
        [90,40,537,'甘肃',3943.7],[87,35.62,209,'青海',1144.2],[118.01,36.37,3743,'山东',33922.5],
        [121,20,1580,'福建',15002.5],[126,25,3291,'浙江',27399.9],[112,31,1507,'河南',22655.0],
        [106,29,1892,'湖北',16226.9],[105,21,1559,'湖南',15574.3],[115,24,1178,'江西',9383.2],
        [125,34,3558,'江苏',41383.9],[119,28,1813,'安徽',13249.8],[114.98,15,4640,'广东',45944.6],
        [109,12,427,'海南',2020.5],[90,25,3446,'四川',17224.8],[95,18,619,'贵州',4519.0],
        [90,15,1616,'云南',7735.3]],
      itemStyle: {
        color: '#90EE90'
      },
    },
  ]
},
{
  tooltip: {
    trigger: 'item',
    formatter: function(params) {
      return `${params.value[3]}<br>酒店数量:${params.value[2]}家\n<br>GDP:${params.value[4]}亿元`;
    }
  },
  legend: {
    show: true,
    data: ['GDP','酒店数量'],
    left: 40,
    top: 20,
  },
  xAxis: {
    scale: true,
  },
  yAxis: {
    scale: true,
  },
  series: [
    {
      name: 'GDP',
      type: 'scatter',
      symbolSize: (data) => {return Math.sqrt(data[4]/15)},
      data: [[130, 31.28 ,10071,'上海',38963.3], [116.40, 45,11395,'北京',35943.3],[120,42,4039,'天津',14008.0],
        [98,25,14308,'重庆',25041.4],[108,48,10169,'内蒙古自治区',17258.0],[100,15,16309,'广西壮族自治区',22120.9],
        [85,31.76,2357,'西藏自治区',1902.7],[100,41,2321,'宁夏回族自治区',3956.3],[84.61,42.89,5516,'新疆维吾尔自治区',13800.7],
        [112,39.44,21719,'河北',36013.8],[105,40,12548,'山西',17835.6],[127,48,6802,'吉林',12256.0],
        [124,44,16220,'辽宁',25011.4],[130,50,10330,'黑龙江',13633.4],[100,35,18086,'陕西',26014.1],
        [90,40,7996,'甘肃',8979.7],[87,35.62,4596,'青海',3009.8],[118.01,36.37,29920,'山东',72798.2],
        [121,20,13215,'福建',43608.6],[126,25,33345,'浙江',64689.1],[112,31,22822,'河南',54259.4],
        [106,29,21810,'湖北',43004.5],[105,21,21079,'湖南',41542.6],[115,24,11678,'江西',25782.0],
        [125,34,29086,'江苏',102807.7],[119,28,18229,'安徽',38061.5],[114.98,15,42281,'广东',111151.6],
        [109,12,5776,'海南',5566.2],[90,25,32769,'四川',48501.6],[95,18,13413,'贵州',17860.4],
        [90,15,26316,'云南',24555.7]],
      itemStyle: {
        color: '#6495ED'
      },
    },
    {
      name: '酒店数量',
      type: 'scatter',
      symbolSize: (data) => {return Math.sqrt(data[2]/8)},
      data: [[130, 31.28 ,10071,'上海',38963.3], [116.40, 45,11395,'北京',35943.3],[120,42,4039,'天津',14008.0],
        [98,25,14308,'重庆',25041.4],[108,48,10169,'内蒙古自治区',17258.0],[100,15,16309,'广西壮族自治区',22120.9],
        [85,31.76,2357,'西藏自治区',1902.7],[100,41,2321,'宁夏回族自治区',3956.3],[84.61,42.89,5516,'新疆维吾尔自治区',13800.7],
        [112,39.44,21719,'河北',36013.8],[105,40,12548,'山西',17835.6],[127,48,6802,'吉林',12256.0],
        [124,44,16220,'辽宁',25011.4],[130,50,10330,'黑龙江',13633.4],[100,35,18086,'陕西',26014.1],
        [90,40,7996,'甘肃',8979.7],[87,35.62,4596,'青海',3009.8],[118.01,36.37,29920,'山东',72798.2],
        [121,20,13215,'福建',43608.6],[126,25,33345,'浙江',64689.1],[112,31,22822,'河南',54259.4],
        [106,29,21810,'湖北',43004.5],[105,21,21079,'湖南',41542.6],[115,24,11678,'江西',25782.0],
        [125,34,29086,'江苏',102807.7],[119,28,18229,'安徽',38061.5],[114.98,15,42281,'广东',111151.6],
        [109,12,5776,'海南',5566.2],[90,25,32769,'四川',48501.6],[95,18,13413,'贵州',17860.4],
        [90,15,26316,'云南',24555.7]],
      itemStyle: {
        color: '#90EE90'
      },
    }
  ]
}
];

const switchChart = (index) => {
  currentChart.value = index;
  chartInstance.setOption(chartsOptions[index]);
};

onMounted(() => {
  chartInstance = echarts.init(chartDom.value);
  chartInstance.setOption(chartsOptions[currentChart.value]);
  
  // 添加窗口大小变化监听
  window.addEventListener('resize', () => {
    if (chartInstance) {
      chartInstance.resize();
    }
  });
});

onUnmounted(() => {
  // 移除事件监听
  window.removeEventListener('resize', () => {
    if (chartInstance) {
      chartInstance.resize();
    }
  });
  
  // 销毁图表实例
  if (chartInstance) {
    chartInstance.dispose();
  }
});

return {
  currentChart,
  switchChart,
  chartDom,
};
}
};
</script>

<style>
.right_part {
width: 100%;
height: 100vh;
display: flex;
flex-direction: column;
align-items: center;
padding: 20px;
box-sizing: border-box;
}

.map-title {
height: 40px;
margin: 0 0 20px 0;
font-size: 24px;
font-weight: bold;
color: #333;
text-align: center;
}

.chart-container {
width: 800px;
height: 600px;
margin-bottom: 20px;
border: 1px solid #eee;
border-radius: 8px;
box-shadow: 0 2px 12px 0 rgba(0,0,0,0.1);
}

.button_group {
width: 100%;
display: flex;
justify-content: center;
gap: 20px;
margin-top: 20px;
}

button {
padding: 10px 30px;
cursor: pointer;
border: none;
border-radius: 5px;
color: white;
font-weight: bold;
transition: all 0.3s ease;
min-width: 120px;
}

button:nth-child(1) {
background-image: linear-gradient(to right, #89f7fe, #66a6ff);
}

button:nth-child(2) {
background-image: linear-gradient(to right, #66a6ff, #4f8ef7);
}

button:nth-child(3) {
background-image: linear-gradient(to right, #4f8ef7, #3872e8);
}

button:hover {
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

button:active, 
button.active {
transform: translateY(1px);
box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

@media screen and (max-width: 900px) {
.chart-container {
width: 95%;
height: 500px;
}

.button_group {
flex-direction: row;
flex-wrap: wrap;
}

button {
flex: 1;
min-width: 100px;
margin: 5px;
}
}

@media screen and (max-width: 600px) {
.chart-container {
height: 400px;
}

.button_group {
flex-direction: column;
align-items: center;
}

button {
width: 80%;
margin: 5px 0;
}
}
</style>
      